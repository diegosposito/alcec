<?php

/**
 * MateriasPlanesTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class MateriasPlanesTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object MateriasPlanesTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('MateriasPlanes');
    }

    public function obtenerMateriasPermitidasCursar($idalumno)
    {   	
		$oAlumno = Doctrine_Core::getTable('Alumnos')->find($idalumno);
		
        $q = Doctrine_Query::create()
            ->select('mp.idmateriaplan, mp.nombre, mp.anodecursada')
            ->from('MateriasPlanes mp')
            ->where('mp.idplanestudio = '.$oAlumno->getIdplanestudio());
       
        return $q->execute();
    }

    // Obtener las materias optativas de la materia
    public function obtenerMateriasComponentes($idtipomateria, $idplanestudio) 
    {	    
    	$q = Doctrine_Query::create()
	  		->select('m.*')
	 		->from('MateriasPlanes m')
	    	->where('m.idtipomateria = '.$idtipomateria)
	    	->andWhere('m.idplanestudio = '.$idplanestudio);
     
		return $q->execute();
    } 

    public function obtenerMateriasPlanAlumno($idalumno)
    {   	
		$oAlumno = Doctrine_Core::getTable('Alumnos')->find($idalumno);
		
        $q = Doctrine_Query::create()
            ->select('mp.idmateriaplan, mp.nombre, mp.anodecursada')
            ->from('MateriasPlanes mp')
            ->where('mp.idplanestudio = '.$oAlumno->getIdplanestudio())
	->orderBy('mp.anodecursada,mp.orden, mp.orden');
       
        return $q->execute();
    }   

    public function obtenerMateriasObligatoriasPlanAlumno($idalumno)
    {   	
		$oAlumno = Doctrine_Core::getTable('Alumnos')->find($idalumno);
		
        $q = Doctrine_Query::create()
            ->select('mp.idmateriaplan, mp.nombre, mp.anodecursada')
            ->from('MateriasPlanes mp')
            ->where('mp.idplanestudio = '.$oAlumno->getIdplanestudio())
            ->andWhere('mp.obligatoria = 1')
	->orderBy('mp.anodecursada,mp.orden, mp.orden');
       
        return $q->execute();
    }   

    public function obtenerMateriasPlan($idplanestudio)
    {   	
		
        $q = Doctrine_Query::create()
            ->select('mp.idmateriaplan, mp.nombre, mp.anodecursada')
            ->from('MateriasPlanes mp')
            ->where('mp.idplanestudio = '.$idplanestudio)
			->orderBy('mp.anodecursada, mp.orden');
       
        return $q->execute();
    }    

   
}
