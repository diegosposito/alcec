<?php

/**
 * SolicitudesTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class SolicitudesTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object SolicitudesTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('Solicitudes');
    }
    
	// Obtiene las solicitudes para el usuario
	public function obtenerSolicitudes($idarea, $idsede, $resuelta)
	{
    	$q = Doctrine_Query::create()
	  		->select("*, u.first_name as nombrea")
	 		->from("Solicitudes s, AreasCarrera c, sfGuardUser u")
	 		->where("s.idsede = ".$idsede)
	 		->andWhere("c.idarea = ".$idarea)
	 		->andWhere("s.resuelta = ".$resuelta)
	 		->andWhere("c.idcarrera = s.idcarrera")
	 		->andWhere("u.id = s.idusuario")	 		
	 		->orderby('updated_at desc')
	    	->execute();
		       
        return $q;
	}    
}