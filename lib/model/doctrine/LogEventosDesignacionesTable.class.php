<?php

/**
 * LogEventosDesignacionesTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class LogEventosDesignacionesTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object LogEventosDesignacionesTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('LogEventosDesignaciones');
    }

    // Contar designaciones que no podran actualizarse por no tener asignada la resolucion de CSU
    public static function obtenerObservacionesPorFacultadSedePeriodo($idfacultad, $idsede, $periodo)
    {
        
        // COnsulta para contar las designaciones a actualizar
        $sql ="SELECT sede, facultad, estado, observaciones, DATE_FORMAT(created_at,'%d/%m/%Y') as fecha
                FROM log_eventos_designaciones 
                WHERE idfacultad=".$idfacultad." AND idsede=".$idsede." AND YEAR(created_at)=".$periodo." ;";

        //echo $sql;exit;

        $q = Doctrine_Manager::getInstance()->getCurrentConnection()->fetchAssoc($sql);
        
        return $q;
    }
}