<?php

/**
 * DesignacionesMesasTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class DesignacionesMesasTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object DesignacionesMesasTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('DesignacionesMesas');
    }
    
   // Obtiene la designacion del profesor a una mesa de examen
   public function obtenerDesignacion($persona, $mesaexamen) 
    {
		$q = Doctrine_Query::create()
  			->select('d.*')
	  		->from('DesignacionesMesas d')
    		->where('d.idmesaexamen = '.$mesaexamen)
    		->andWhere('d.idpersona = '.$persona);    		
    		
	    return $q->fetchOne();
    }	
    
   // Obtiene la designacion del profesor a una mesa de examen
   public function controlarDesignacion($idprofesor, $idmesaexamen, $idtipodesignacionmesa) 
    {
		$resultado = "";
	
    	$q = Doctrine_Query::create()
  			->select('d.*')
	  		->from('DesignacionesMesas d')
    		->where('d.idmesaexamen = '.$idmesaexamen)
    		->andWhere('d.idprofesor = '.$idprofesor)
    		->fetchOne();
    	if($q){
    		$resultado = "Ya se encuentra designado dicho profesor.";
    	}
    	
		$q = Doctrine_Query::create()
			->select('d.*')
			->from('DesignacionesMesas d')
			->where('d.idmesaexamen = '.$idmesaexamen)
			->andWhere('d.idtipodesignacionmesa = '.$idtipodesignacionmesa)
			->fetchOne();  
        if($q){
    		$resultado = "Ya se encuentra designado dicho carÃ¡cter.";
    	}		
        
    	$q = Doctrine_Query::create()
  			->select('d.*')
	  		->from('DesignacionesMesas d')
    		->where('d.idmesaexamen = '.$idmesaexamen)
    		->execute();
		if(count($q)>= 3){
			$resultado = "Ya se encuentran designados los 3 profesores.";
		}
	    return $resultado;
    }	         
}